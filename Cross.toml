[target.aarch64-unknown-linux-gnu]
image = "ghcr.io/cross-rs/aarch64-unknown-linux-gnu@sha256:1e2a0291f92a4372cbc22d8994e735473045383f1ce7fa44a16c234ba00187f4"
pre-build = [
    "dpkg --add-architecture arm64",
    "apt-get update || true",
    "apt-get install -y pkg-config:arm64 zlib1g-dev:arm64 libssl-dev:arm64 libsasl2-dev:arm64 libzstd-dev:arm64 liblz4-dev:arm64 || true",
    # debug: confirm zlib and headers exist
    "ls -R /usr/lib/aarch64-linux-gnu || true",
    "ls -R /usr/include/aarch64-linux-gnu || true",
]

[target.aarch64-unknown-linux-gnu.env]
passthrough = [
    "LIBRDKAFKA_SSL_VENDORED",
    "PKG_CONFIG_ALLOW_CROSS",
    "CROSS_NO_WARNINGS",
    "RUST_BACKTRACE",
    # Zlib hints for CMake
    "ZLIB_ROOT",
    "ZLIB_INCLUDE_DIR",
    "ZLIB_LIBRARY",
    # OpenSSL hints
    "OPENSSL_ROOT_DIR",
    "OPENSSL_INCLUDE_DIR",
    "OPENSSL_CRYPTO_LIBRARY",
    "OPENSSL_SSL_LIBRARY",
    "PKG_CONFIG_PATH",
]
volumes = [
    "/usr/lib/aarch64-linux-gnu:/usr/lib/aarch64-linux-gnu:ro",
    "/usr/include/aarch64-linux-gnu:/usr/include/aarch64-linux-gnu:ro",
]

[target.x86_64-unknown-linux-gnu]
image = "ghcr.io/cross-rs/x86_64-unknown-linux-gnu@sha256:bf05360bb9d6d4947eed60532ac7a0d7e8fae8f214e9abb801d5941c8fe4918d"
